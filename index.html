<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>åœŸåœ°è¤‡ä¸ˆè¦è²»è©¦ç®—</title>
  <link rel="manifest" href="manifest.json">
  <link rel="stylesheet" href="style.css">

  <!-- æ­£ç¢ºï¼šæŒ‡å‘ /lhu/ ç›®éŒ„ä¸‹çš„æª”æ¡ˆ -->
  <link rel="manifest" href="./manifest.json">
  <link rel="apple-touch-icon" href="https://lhu8888677.github.io/icons/icon-192.png">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="theme-color" content="#cc5500">
</head>
<script>
if ('serviceWorker' in navigator) {
  navigator.serviceWorker.register('./service-worker.js', { scope: './' })
    .then(() => console.log('SW registered'))
    .catch(console.error);
}
</script>

  <style>
    body {
      font-family: "Microsoft JhengHei", sans-serif;
      text-align: center;
      background: #f5f5f5;
      padding: 40px;
    }
    .box {
      background: white;
      border-radius: 10px;
      padding: 30px;
      box-shadow: 0 0 10px rgba(0,0,0,0.1);
      display: inline-block;
    }
    input, select, button {
      margin: 6px;
      padding: 8px;
      font-size: 16px;
    }
    #result span {
      color: red;
      font-weight: bold;
      display: block;
      margin: 4px 0;
    }
    #history {
      margin-top: 20px;
      text-align: left;
      max-width: 500px;
      margin-left: auto;
      margin-right: auto;
    }
    #history ul {
      padding-left: 20px;
    }
    #history li {
      line-height: 1.6;
    }
  </style>
</head>
<body>
  <div class="box">

    <!-- ğŸ“Œ LOGO + æ¨™é¡Œ + è¯çµ¡è³‡è¨Š -->
    <div style="text-align: center; margin-bottom: 20px;">
      <img src="logo.png" alt="å¥‘åˆä¸å‹•ç”¢ LOGO" style="width: 90px; height: auto; display: block; margin: 0 auto 10px;">
      <h2 style="margin: 10px 0;">åœŸåœ°è¤‡ä¸ˆè¦è²»è©¦ç®—ï¼ˆåŠŸèƒ½ç‰ˆï¼‰</h2>
      <p>ä¸å‹•ç”¢ç¶“ç´€äººï¼šæ—æ¢ç¥–<br>
        é›»è©±ï¼š<a href="tel:0912428605">0912428605</a>
      </p>
    </div>

    <!-- ğŸ“Œ è©¦ç®—è¡¨å–® -->
    <label>è¤‡ä¸ˆé¡å‹ï¼š</label>
    <select id="type">
      <option value="é‘‘ç•Œè¤‡ä¸ˆ">é‘‘ç•Œè¤‡ä¸ˆ</option>
      <option value="åˆ†å‰²ç­‰">åˆ†å‰²ã€èª¿æ•´ç­‰</option>
    </select><br>

    <label>åœŸåœ°é¢ç©ï¼ˆã¡ï¼‰ï¼š</label>
    <input type="number" id="area" value="100"><br>

    <label>æ–½æ¸¬å–®ä½æ•¸ï¼š</label>
    <input type="number" id="units" value="5"><br>

    <button onclick="calculate()">è©¦ç®—</button>

    <div id="result" style="margin-top:20px;"></div>

    <!-- ğŸ“Œ æ“ä½œæŒ‰éˆ• -->
    <div style="margin-top:20px;">
      <button onclick="exportTXT()">åŒ¯å‡º TXT</button>
      <button onclick="window.print()">åˆ—å°æœ¬é </button>
      <button onclick="showHistory()">æ­·å²ç´€éŒ„</button>
      <button onclick="clearHistory()">æ¸…é™¤æ­·å²ç´€éŒ„</button>
    </div>

    <!-- ğŸ“Œ æ­·å²ç´€éŒ„ -->
    <div id="history"></div>

    <!-- ğŸ“Œ å¿«é€Ÿé€£çµ -->
    <div style="margin-top: 30px; text-align: left;">
      <hr>
      <p style="font-weight: bold;">å¿«é€Ÿé€£çµï½œFOLLOW US</p>
      <p>ğŸ‘‰ <a href="https://line.me/ti/p/aLynUIRtsJ" target="_blank">LINE è«®è©¢</a></p>
      <p>ğŸ‘‰ <a href="https://www.facebook.com/profile.php?id=100082625327420" target="_blank">Facebook ç²‰å°ˆ</a></p>
      <p>ğŸ‘‰ <a href="https://www.facebook.com/groups/923714991628656" target="_blank">Facebook ç¤¾åœ˜</a></p>
      <p>ğŸ‘‰ <a href="https://www.instagram.com/hanwu_liang/" target="_blank">IGï¼š@hanwu_liang</a></p>
      <p>ğŸ‘‰ <a href="https://www.youtube.com/@h-ul4237" target="_blank">YouTube é »é“</a></p>
      <p>ğŸ‘‰ <a href="https://www.threads.net/@hanwu_liang" target="_blank">Threads</a></p>
    </div>

    <!-- ğŸ“Œ åˆ†äº«èˆ‡å®‰è£æç¤º -->
    <hr style="margin-top: 40px;">
    <p><strong>ğŸ“± åˆ†äº«èˆ‡å®‰è£æç¤º</strong></p>
    <button onclick="sharePage()" style="padding:8px 20px;border-radius:6px;background:#007bff;color:white;border:none;">ğŸ”— åˆ†äº«æ­¤ç¶²ç«™</button>
    <button id="installBtn" style="padding:8px 20px;border-radius:6px;background:#28a745;color:white;border:none;display:none;">ğŸ“² åŠ å…¥ä¸»ç•«é¢</button>
    <p style="margin-top: 10px;">ğŸ“Œ æ‚¨å¯ä½¿ç”¨ç€è¦½å™¨é¸å–®åŠŸèƒ½ã€ŒåŠ å…¥ä¸»ç•«é¢ã€ä¾†å¿«é€Ÿå•Ÿç”¨æ­¤å·¥å…·</p>

    <!-- ğŸ“Œ å‰å¾€å¿«é€Ÿå°è¦½ -->
    <div style="margin-top: 30px;">
      <a href="https://lhu8888677.github.io/index_links.html" style="display:inline-block;padding:10px 20px;border-radius:8px;background:#cc5500;color:#fff;text-decoration:none;">ğŸ“Œ å‰å¾€å¿«é€Ÿå°è¦½é </a>
    </div>

  </div>

  <!-- ğŸ“Œ PWA å®‰è£æç¤ºè…³æœ¬ -->
  <script>
    let deferredPrompt;
    window.addEventListener('beforeinstallprompt', (e) => {
      e.preventDefault();
      deferredPrompt = e;

      const installBtn = document.getElementById("installBtn");
      if (installBtn) {
        installBtn.style.display = "inline-block";
        installBtn.addEventListener('click', () => {
          deferredPrompt.prompt();
          deferredPrompt.userChoice.then((choiceResult) => {
            if (choiceResult.outcome === 'accepted') {
              console.log('ä½¿ç”¨è€…æ¥å—å®‰è£');
            } else {
              console.log('ä½¿ç”¨è€…å–æ¶ˆå®‰è£');
            }
            deferredPrompt = null;
          });
        });
      }
    });
  </script>

  <!-- ğŸ“Œ åŸæœ¬çš„åŠŸèƒ½è…³æœ¬ -->
  <script>
    function getBase(type, area) {
      if (area < 200) return type === "é‘‘ç•Œè¤‡ä¸ˆ" ? 2500 : 1500;
      else if (area >= 200 && area < 1000) return type === "é‘‘ç•Œè¤‡ä¸ˆ" ? 3000 : 2000;
      else if (area >= 1000 && area < 10000) return type === "é‘‘ç•Œè¤‡ä¸ˆ" ? 3500 : 2500;
      else return type === "é‘‘ç•Œè¤‡ä¸ˆ" ? 4000 : 3000;
    }
    function calculate(){
      const area = parseFloat(document.getElementById("area").value) || 0;
      const units = parseInt(document.getElementById("units").value) || 0;
      const type = document.getElementById("type").value;
      const base = getBase(type, area);
      const unitRate = type === "é‘‘ç•Œè¤‡ä¸ˆ" ? 1000 : 500;
      const unitCount = type === "é‘‘ç•Œè¤‡ä¸ˆ" ? Math.ceil(units / 5) : units;
      const unitFee = unitRate * unitCount;
      const total = base + unitFee;

      document.getElementById("result").innerHTML =
        '<span>åŸºæœ¬è²»ï¼š' + base + ' å…ƒ</span>' +
        '<span>æ–½æ¸¬è²»ï¼ˆ' + unitCount + ' å–®ä½ Ã— ' + unitRate + ' å…ƒï¼‰ï¼š' + unitFee + ' å…ƒ</span>' +
        '<span>åˆè¨ˆï¼š' + total + ' å…ƒ</span>';

      let h = JSON.parse(localStorage.getItem("calcHistory") || "[]");
      h.unshift(`é¡å‹ï¼š${type}ï½œé¢ç©ï¼š${area}ã¡ï½œå–®ä½ï¼š${units}ï½œå…±ï¼š${total}å…ƒ`);
      if (h.length > 10) h = h.slice(0, 10);
      localStorage.setItem("calcHistory", JSON.stringify(h));
    }

    function exportTXT() {
      const t = document.getElementById("result").innerText;
      const b = new Blob([t], { type: "text/plain" });
      const u = URL.createObjectURL(b);
      const a = document.createElement("a");
      a.href = u;
      a.download = "è¤‡ä¸ˆè©¦ç®—çµæœ.txt";
      document.body.appendChild(a);
      a.click();
      document.body.removeChild(a);
    }

    function showHistory() {
      const h = JSON.parse(localStorage.getItem("calcHistory") || "[]");
      let html = "<strong>æ­·å²ç´€éŒ„</strong><ul>";
      h.forEach(i => html += "<li>" + i + "</li>");
      html += "</ul>";
      document.getElementById("history").innerHTML = html;
    }

    function clearHistory() {
      localStorage.removeItem("calcHistory");
      document.getElementById("history").innerHTML = "";
    }

    function sharePage() {
      if (navigator.share) {
        navigator.share({
          title: 'åœŸåœ°è¤‡ä¸ˆè¦è²»è©¦ç®—',
          text: 'å¿«é€Ÿè©¦ç®—è¦è²»å·¥å…·ï¼Œç«‹å³ä½¿ç”¨ï¼',
          url: window.location.href
        }).then(() => {
          console.log('åˆ†äº«æˆåŠŸ');
        }).catch((error) => {
          console.log('åˆ†äº«å¤±æ•—', error);
        });
      } else {
        alert('æ‚¨çš„ç€è¦½å™¨ä¸æ”¯æ´åˆ†äº«åŠŸèƒ½ï¼Œè«‹æ‰‹å‹•è¤‡è£½ç¶²å€');
      }
    }
  </script>
</body>

</html>
