
<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>土地複丈規費試算（功能版）</title>

  <style>
    :root{--brand:#cc5500;--ink:#222;--muted:#666;--bg:#f6f6f6;--card:#fff;}
    *{box-sizing:border-box}
    body{margin:0;background:var(--bg);color:var(--ink);font-family:"Microsoft JhengHei",system-ui,-apple-system,"Segoe UI",Roboto,"Noto Sans TC",sans-serif}
    .shell{min-height:100svh;display:grid;place-items:center;padding:24px}
    .box{width:min(560px,100%);background:var(--card);border-radius:16px;padding:24px;box-shadow:0 6px 18px rgba(0,0,0,.08)}
    .logo{width:90px;height:auto;display:block;margin:8px auto 12px}
    h2{margin:6px 0 2px;font-size:22px;text-align:center}
    .sub{margin:0 0 16px;color:var(--muted);font-size:12px;text-align:center}
    label{display:inline-block;margin:10px 8px 6px 0}
    input,select,button{font:inherit}
    input,select{width:100%;padding:10px 12px;border:1px solid #ddd;border-radius:10px}
    .grid{display:grid;gap:10px}
    .grid.cols-2{grid-template-columns:1fr 1fr}
    @media (max-width:480px){ .grid.cols-2{grid-template-columns:1fr} }
    .btn{display:inline-block;padding:10px 14px;border-radius:10px;border:1px solid #ddd;background:#fff;color:#222;text-decoration:none;cursor:pointer}
    .btn-primary{background:var(--brand);border-color:var(--brand);color:#fff}
    .btn-bar{display:flex;gap:10px;flex-wrap:wrap;justify-content:center;margin-top:12px}
    #result span{display:block;margin-top:4px;color:#d11;font-weight:700}
    .links{line-height:1.9;margin-top:16px}
    .muted{color:var(--muted);font-size:12px;text-align:center}
    hr{border:none;border-top:1px solid #eee;margin:18px 0}
  </style>
</head>
<body>
  <div class="shell">
    <main class="box">
      <img class="logo" src="./logo.png" alt="契合不動產 LOGO" />

      <h2>土地複丈規費試算（功能版）</h2>
      <p class="sub">依內政部收費基準表邏輯製作，結果僅供參考。</p>

      <div class="grid">
        <label>複丈類型：</label>
        <select id="type">
          <option value="鑑界複丈">鑑界複丈</option>
          <option value="分割等">分割、調整等</option>
        </select>

        <label>土地面積（㎡）：</label>
        <input type="number" id="area" value="100" />

        <label>施測單位數：</label>
        <input type="number" id="units" value="5" />
      </div>

      <div class="btn-bar">
        <button class="btn btn-primary" onclick="calculate()">試算</button>
        <button class="btn" onclick="exportTXT()">匯出 TXT</button>
        <button class="btn" onclick="window.print()">列印本頁</button>
        <button class="btn" onclick="showHistory()">歷史紀錄</button>
        <button class="btn" onclick="clearHistory()">清除歷史紀錄</button>
        <button class="btn" onclick="sharePage()">分享此網站</button>
      </div>

      <div id="result" style="margin-top:12px;"></div>
      <div id="history" style="margin-top:8px;"></div>

      <hr />

      <div class="links">
        <strong>快速連結｜FOLLOW US</strong><br>
        👉 <a href="https://line.me/ti/p/aLynUIRtsJ" target="_blank" rel="noopener">LINE 諮詢</a><br>
        👉 <a href="https://www.facebook.com/profile.php?id=100082625327420" target="_blank" rel="noopener">Facebook 粉專</a><br>
        👉 <a href="https://www.facebook.com/groups/923714991628656" target="_blank" rel="noopener">Facebook 社團</a><br>
        👉 <a href="https://www.instagram.com/hanwu_liang/" target="_blank" rel="noopener">IG：@hanwu_liang</a><br>
        👉 <a href="https://www.youtube.com/@h-ul4237" target="_blank" rel="noopener">YouTube 頻道</a><br>
        👉 <a href="https://www.threads.net/@hanwu_liang" target="_blank" rel="noopener">Threads</a>
      </div>

      <!-- 離線版入口 -->
      <div class="btn-bar">
        <a class="btn btn-primary" href="./lhu/離線版/index.html" rel="noopener">
          📥 使用離線版試算（免網路可操作）
        </a>
        <a class="btn" href="./index_links.html" target="_blank" rel="noopener">
          📌 前往快速導覽頁
        </a>
      </div>

      <p class="muted" style="margin-top:8px;">第一次啟用離線版需連網快取，之後可離線使用（外部連結需網路）。</p>
    </main>
  </div>

  <script>
    function getBase(type, area){
      if (area < 200) return type === "鑑界複丈" ? 2500 : 1500;
      else if (area < 1000) return type === "鑑界複丈" ? 3000 : 2000;
      else if (area < 10000) return type === "鑑界複丈" ? 3500 : 2500;
      else return type === "鑑界複丈" ? 4000 : 3000;
    }
    function calculate(){
      const area = parseFloat(document.getElementById("area").value) || 0;
      const units = parseInt(document.getElementById("units").value) || 0;
      const type = document.getElementById("type").value;
      const base = getBase(type, area);
      const unitRate = (type === "鑑界複丈") ? 1000 : 500;
      const unitCount = (type === "鑑界複丈") ? Math.ceil(units/5) : units;
      const unitFee = unitRate * unitCount;
      const total = base + unitFee;

      document.getElementById("result").innerHTML =
        '<span>基本費：' + base + ' 元</span>' +
        '<span>施測費（' + unitCount + ' 單位 × ' + unitRate + ' 元）：' + unitFee + ' 元</span>' +
        '<span>合計：' + total + ' 元</span>';

      let h = JSON.parse(localStorage.getItem("calcHistory") || "[]");
      h.unshift(`類型：${type}｜面積：${area}㎡｜單位：${units}｜共：${total}元`);
      if (h.length > 10) h = h.slice(0, 10);
      localStorage.setItem("calcHistory", JSON.stringify(h));
    }
    function exportTXT(){
      const t = document.getElementById("result").innerText || '尚未試算';
      const b = new Blob([t], {type:'text/plain'});
      const u = URL.createObjectURL(b);
      const a = document.createElement('a');
      a.href = u; a.download = '複丈試算結果.txt';
      document.body.appendChild(a); a.click(); a.remove();
      URL.revokeObjectURL(u);
    }
    function showHistory(){
      const h = JSON.parse(localStorage.getItem("calcHistory") || "[]");
      let html = "<strong>歷史紀錄</strong><ul>";
      h.forEach(i => html += "<li>" + i + "</li>");
      html += "</ul>";
      document.getElementById("history").innerHTML = html;
    }
    function clearHistory(){
      localStorage.removeItem("calcHistory");
      document.getElementById("history").innerHTML = "";
    }
    function sharePage(){
      const data = { title:'土地複丈規費試算', text:'快速試算規費工具', url: location.href };
      if (navigator.share) navigator.share(data).catch(()=>{});
      else { navigator.clipboard.writeText(location.href); alert('已複製網址，可貼給客戶。'); }
    }
  </script>
</body>
</html>
